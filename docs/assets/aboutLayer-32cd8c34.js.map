{"version":3,"file":"aboutLayer-32cd8c34.js","sources":["../../components/core/aboutLayer/aboutLayer.js"],"sourcesContent":["import './aboutLayer.css';\n\nimport Alpine from 'alpinejs';\nimport { renderMarkupAndSetPluginReady } from '../../core/helper.js'\n\nconst createOffCanvasMarkup = () => {\n\n  let aboutOffcanvas = `\n    <div \n        class=\"position-absolute start-0 top-0 bg-white h-100 w-40 p-3 shadow z-2 overflow-auto\" \n        x-transition tabindex=\"-1\" \n        id=\"aboutOffcanvas\" \n        aria-labelledby=\"aboutOffcanvasLabel\"\n        x-show=\"$store.aboutLayer.componentIsActive\">\n      <div class=\"offcanvas-header mb-4\">\n        <h5 class=\"offcanvas-title\" id=\"aboutOffcanvasLabel\" x-text=\"$store.aboutLayer.mapName\">Filter</h5>\n        <button type=\"button\" class=\"btn-close text-reset\" data-bs-dismiss=\"offcanvas\" aria-label=\"Close\" @click=\"$store.aboutLayer.componentIsActive = false;\"></button>\n      </div>\n\n      <div class=\"offcanvas-body\">\n            <img :src=\"$store.aboutLayer.layer?.dataset?.thumbnail_url || ''\">\n            <table class=\"table table-striped\">\n                <tbody>\n                    <template x-for=\"[key, value] in Object.entries($store.aboutLayer.metadata)\" :key=\"key\">\n                        <tr>\n                            <td x-text=\"$store.aboutLayer.pritfyName(key)\" class=\"aboutKey\"></td>\n                            <td x-html=\"value\" class=\"aboutValue\"></td>\n                        </tr>\n                    </template>   \n                </tbody>\n            </table>   \n        </div>\n  </div>`;\n\n  document.getElementById('map').insertAdjacentHTML('afterend', aboutOffcanvas);\n}\n\n\n\nconst initialize = () => {\n\n  Alpine.store('aboutLayer', {\n      componentIsActive: false,\n      layer: {},\n      allowedKeys: ['data_quality_statement', 'abstract', 'created', 'license', 'maintenance_frequency','metadata_author', 'poc', 'srid', 'supplemental_information'],\n      metadata: {},\n      mapName: \"\",\n      pritfyName: function (name) {\n        name = name.replaceAll(\"_\", \" \");\n        return name;\n      }\n    });\n\n    // Catch the custom event and execute a function to update the legend\n    document.addEventListener('aboutPushed', function (event) {\n        console.debug('Custom event \"aboutPushed\" caught in aboutLayer/aboutLayer.js');\n        const aboutLayer = Alpine.store('aboutLayer');\n        const layer = event.detail.instance;\n\n        aboutLayer.layer = layer;\n        aboutLayer.mapName = layer.mapName;\n        aboutLayer.componentIsActive = true;\n    \n        // Initialize a new metadata object\n        const newMetadata = {};\n\n        // Fill newMetadata only with specified keys if they exist in the layer's dataset\n        aboutLayer.allowedKeys.forEach(key => {\n            if (layer.dataset.hasOwnProperty(key)) {\n                newMetadata[key] = layer.dataset[key];\n                if (key == 'poc'){\n                    newMetadata[key] = layer.dataset[key]['username'];\n                }\n            }\n        });\n        \n        console.log(\"newMetadata\")\n        console.log(newMetadata)\n        // Update the metadata in the store\n        aboutLayer.metadata = newMetadata;\n    \n    });\n    \n  // [function name that creates the DOM Element, Element to check for presence}\n  const domElementsToCreate = [\n      [createOffCanvasMarkup, '#aboutOffcanvas'],\n  ]\n\n  // this function tirggers the rendering and tells main.js that initialization is finished\n  renderMarkupAndSetPluginReady(domElementsToCreate)\n\n};\n\n\nexport { initialize };"],"names":["createOffCanvasMarkup","aboutOffcanvas","initialize","Alpine","name","event","aboutLayer","layer","newMetadata","key","renderMarkupAndSetPluginReady"],"mappings":"+CAKA,MAAMA,EAAwB,IAAM,CAElC,IAAIC,EAAiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UA2BrB,SAAS,eAAe,KAAK,EAAE,mBAAmB,WAAYA,CAAc,CAC9E,EAIMC,EAAa,IAAM,CAEvBC,EAAO,MAAM,aAAc,CACvB,kBAAmB,GACnB,MAAO,CAAE,EACT,YAAa,CAAC,yBAA0B,WAAY,UAAW,UAAW,wBAAwB,kBAAmB,MAAO,OAAQ,0BAA0B,EAC9J,SAAU,CAAE,EACZ,QAAS,GACT,WAAY,SAAUC,EAAM,CAC1B,OAAAA,EAAOA,EAAK,WAAW,IAAK,GAAG,EACxBA,CACR,CACP,CAAK,EAGD,SAAS,iBAAiB,cAAe,SAAUC,EAAO,CACtD,QAAQ,MAAM,+DAA+D,EAC7E,MAAMC,EAAaH,EAAO,MAAM,YAAY,EACtCI,EAAQF,EAAM,OAAO,SAE3BC,EAAW,MAAQC,EACnBD,EAAW,QAAUC,EAAM,QAC3BD,EAAW,kBAAoB,GAG/B,MAAME,EAAc,CAAA,EAGpBF,EAAW,YAAY,QAAQG,GAAO,CAC9BF,EAAM,QAAQ,eAAeE,CAAG,IAChCD,EAAYC,CAAG,EAAIF,EAAM,QAAQE,CAAG,EAChCA,GAAO,QACPD,EAAYC,CAAG,EAAIF,EAAM,QAAQE,CAAG,EAAE,UAG1D,CAAS,EAED,QAAQ,IAAI,aAAa,EACzB,QAAQ,IAAID,CAAW,EAEvBF,EAAW,SAAWE,CAE9B,CAAK,EAQHE,EAL4B,CACxB,CAACV,EAAuB,iBAAiB,CAC5C,CAGgD,CAEnD"}