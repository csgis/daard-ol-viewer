import{m,H as d,h as g,P as f,v as u,u as p,S as h,Q as k,K as v}from"./index-065f7d44.js";import{f as M}from"./feather-becb2378.js";const S=()=>{const o=M.icons["map-pin"].toSvg({class:"custom-pin",width:36,height:36,stroke:"black",fill:"yellow"});return new h({image:new k({imgSize:[36,36],anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",src:"data:image/svg+xml;utf8,"+encodeURIComponent(o)})})},w=o=>parseFloat(o.replace(/vh$/,""))*document.documentElement.clientHeight/100,x=(o,e=!1,s=!1,r=!1,t)=>{d.getSource().clear();const l=S();let n=[];if(o.forEach(i=>{const a=new g({geometry:new f(i)});a.setStyle(l),d.getSource().addFeature(a),n.push(a.getGeometry().getExtent())}),e){if(n.length===1){const i=o[0];let a=i;const c=u.getZoom();(s||r)&&(a=y(v,i,c,s,r)),u.animate({center:a,zoom:c,duration:500})}else if(n.length>1){t=(typeof t=="string"&&t.includes("vh")?w(t):t)+150;const a=p(n),c=[100,100,t,100];u.fit(a,{padding:c,duration:500})}}};function y(o,e,s,r,t){const l=o.getSize(),n=o.getView();n.setZoom(s);const i=n.getResolutionForZoom(s),a=l[0]/4*i,c=t?[e[0]-a,e[1]]:[e[0]+a,e[1]];return n.setZoom(n.getZoom()),c}const P=()=>{d.getSource().clear()},z=async o=>{m.store("mapMarker",{markers:o,addMarkers:function(e=!1,s,r,t){x(this.markers,e,s,r,t)},removeMarkers:function(){P()}}),document.addEventListener("addMapPins",function(e){console.debug('Custom event "addMapPins" caught in mapMarker/mapMarker.js');const s=e.detail.pin_coordinates,r=e.detail.fitView||!1,t=e.detail.moveCenterLeft||!1,l=e.detail.moveCenterRight||!1,n=e.detail.bottomPadding||600;console.log("Event padding",n),m.store("mapMarker").markers=s,m.store("mapMarker").addMarkers(r,t,l,n)}),document.addEventListener("deleteMapPins",function(e){console.debug('Custom event "deleteMapPins" caught in mapMarker/mapMarker.js'),m.store("mapMarker").removeMarkers()}),m.store("pluginStatus").increasePluginLoadingStatus()};export{z as initialize};
//# sourceMappingURL=mapMarker-8a019ce8.js.map
