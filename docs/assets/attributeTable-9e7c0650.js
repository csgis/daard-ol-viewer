import{b as V,c as X,F as tt,d as rt,t as le,h as ue,i as nt,P as it,M as st,j as Ze,k as Ye,L as ze,l as ot,n as $e,o as G,p as Ve,m as F,q as at,e as U,u as H,w as K,a as k,r as lt,x as ut}from"./index-3d490d7e.js";import{d as pt}from"./contentDecorator-492207c9.js";import{f as ct}from"./feather-becb2378.js";class dt{constructor(e){this.tagName_=e}getTagName(){return this.tagName_}}const pe=dt;class mt extends pe{constructor(e,t){super(e),this.conditions=t,V(this.conditions.length>=2,57)}}const Xe=mt;class gt extends Xe{constructor(e){super("And",Array.prototype.slice.call(arguments))}}const ft=gt;class ht extends pe{constructor(e,t,r){if(super("BBOX"),this.geometryName=e,this.extent=t,t.length!==4)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");this.srsName=r}}const yt=ht;class wt extends pe{constructor(e,t){super(e),this.propertyName=t}}const Et=wt;class Rt extends Et{constructor(e,t,r,n){super(e,t),this.expression=r,this.matchCase=n}}const St=Rt;class Pt extends St{constructor(e,t,r){super("PropertyIsEqualTo",e,t,r)}}const Nt=Pt;class Mt extends Xe{constructor(e){super("Or",Array.prototype.slice.call(arguments))}}const Lt=Mt;function qe(o){const e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(ft,e))}function _t(o){const e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Lt,e))}function Ct(o,e,t){return new yt(o,e,t)}function At(o,e,t){return new Nt(o,e,t)}const oe="http://www.w3.org/2001/XMLSchema-instance";function y(o,e){return Qe().createElementNS(o,e)}function q(o,e){return We(o,e,[]).join("")}function We(o,e,t){if(o.nodeType==Node.CDATA_SECTION_NODE||o.nodeType==Node.TEXT_NODE)e?t.push(String(o.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(o.nodeValue);else{let r;for(r=o.firstChild;r;r=r.nextSibling)We(r,e,t)}return t}function Z(o){return"documentElement"in o}function Tt(o,e,t){return o.getAttributeNS(e,t)||""}function Y(o){return new DOMParser().parseFromString(o,"application/xml")}function He(o,e){return function(t,r){const n=o.call(e!==void 0?e:this,t,r);if(n!==void 0){const i=r[r.length-1];X(i,n)}}}function h(o,e){return function(t,r){const n=o.call(e!==void 0?e:this,t,r);n!==void 0&&r[r.length-1].push(n)}}function d(o,e){return function(t,r){const n=o.call(e!==void 0?e:this,t,r);n!==void 0&&(r[r.length-1]=n)}}function I(o,e,t){return function(r,n){const i=o.call(t!==void 0?t:this,r,n);if(i!==void 0){const s=n[n.length-1],a=e!==void 0?e:r.localName;s[a]=i}}}function l(o,e){return function(t,r,n){o.call(e!==void 0?e:this,t,r,n),n[n.length-1].node.appendChild(t)}}function A(o,e){return function(t,r,n){const s=r[r.length-1].node;let a=o;a===void 0&&(a=n);const u=e!==void 0?e:s.namespaceURI;return y(u,a)}}const Ke=A();function D(o,e,t,r){let n;for(n=e.firstElementChild;n;n=n.nextElementSibling){const i=o[n.namespaceURI];if(i!==void 0){const s=i[n.localName];s!==void 0&&s.call(r,n,t)}}}function P(o,e,t,r,n){return r.push(o),D(e,t,r,n),r.pop()}function bt(o,e,t,r,n,i){const s=(n!==void 0?n:t).length;let a,u;for(let p=0;p<s;++p)a=t[p],a!==void 0&&(u=e.call(i!==void 0?i:this,a,r,n!==void 0?n[p]:void 0),u!==void 0&&o[u.namespaceURI][u.localName].call(i,u,a,r))}function L(o,e,t,r,n,i,s){return n.push(o),bt(e,t,r,n,i,s),n.pop()}let ne;function It(){return ne===void 0&&typeof XMLSerializer<"u"&&(ne=new XMLSerializer),ne}let ie;function Qe(){return ie===void 0&&typeof document<"u"&&(ie=document.implementation.createDocument("","",null)),ie}class Ot extends tt{constructor(){super(),this.xmlSerializer_=It()}getType(){return"xml"}readFeature(e,t){if(e)if(typeof e=="string"){const r=Y(e);return this.readFeatureFromDocument(r,t)}else return Z(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t);else return null}readFeatureFromDocument(e,t){const r=this.readFeaturesFromDocument(e,t);return r.length>0?r[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(e)if(typeof e=="string"){const r=Y(e);return this.readFeaturesFromDocument(r,t)}else return Z(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t);else return[]}readFeaturesFromDocument(e,t){const r=[];for(let n=e.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&X(r,this.readFeaturesFromNode(n,t));return r}readFeaturesFromNode(e,t){return rt()}readGeometry(e,t){if(e)if(typeof e=="string"){const r=Y(e);return this.readGeometryFromDocument(r,t)}else return Z(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t);else return null}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(e)if(typeof e=="string"){const t=Y(e);return this.readProjectionFromDocument(t)}else return Z(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e);else return null}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const r=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const r=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const r=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,t){return null}}const Je=Ot,x="http://www.opengis.net/gml",Ft=/^\s*$/;class _ extends Je{constructor(e){super(),e=e||{},this.featureType=e.featureType,this.featureNS=e.featureNS,this.srsName=e.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:h(this.readFeaturesInternal),featureMembers:d(this.readFeaturesInternal)},this.supportedMediaTypes=["application/gml+xml"]}readFeaturesInternal(e,t){const r=e.localName;let n=null;if(r=="FeatureCollection")n=P([],this.FEATURE_COLLECTION_PARSERS,e,t,this);else if(r=="featureMembers"||r=="featureMember"||r=="member"){const i=t[0];let s=i.featureType,a=i.featureNS;const u="p",p="p0";if(!s&&e.childNodes){s=[],a={};for(let m=0,N=e.childNodes.length;m<N;++m){const M=e.childNodes[m];if(M.nodeType===1){const b=M.nodeName.split(":").pop();if(!s.includes(b)){let O="",ye=0;const we=M.namespaceURI;for(const Ee in a){if(a[Ee]===we){O=Ee;break}++ye}O||(O=u+ye,a[O]=we),s.push(O+":"+b)}}}r!="featureMember"&&(i.featureType=s,i.featureNS=a)}if(typeof a=="string"){const m=a;a={},a[p]=m}const f={},g=Array.isArray(s)?s:[s];for(const m in a){const N={};for(let M=0,b=g.length;M<b;++M)(g[M].includes(":")?g[M].split(":")[0]:p)===m&&(N[g[M].split(":").pop()]=r=="featureMembers"?h(this.readFeatureElement,this):d(this.readFeatureElement,this));f[a[m]]=N}r=="featureMember"||r=="member"?n=P(void 0,f,e,t):n=P([],f,e,t)}return n===null&&(n=[]),n}readGeometryOrExtent(e,t){const r=t[0];return r.srsName=e.firstElementChild.getAttribute("srsName"),r.srsDimension=e.firstElementChild.getAttribute("srsDimension"),P(null,this.GEOMETRY_PARSERS,e,t,this)}readExtentElement(e,t){const r=t[0],n=this.readGeometryOrExtent(e,t);return n?le(n,r):void 0}readGeometryElement(e,t){const r=t[0],n=this.readGeometryOrExtent(e,t);return n?ue(n,!1,r):void 0}readFeatureElementInternal(e,t,r){let n;const i={};for(let s=e.firstElementChild;s;s=s.nextElementSibling){let a;const u=s.localName;s.childNodes.length===0||s.childNodes.length===1&&(s.firstChild.nodeType===3||s.firstChild.nodeType===4)?(a=q(s,!1),Ft.test(a)&&(a=void 0)):(r&&(a=u==="boundedBy"?this.readExtentElement(s,t):this.readGeometryElement(s,t)),a?u!=="boundedBy"&&(n=u):a=this.readFeatureElementInternal(s,t,!1));const p=s.attributes.length;if(p>0){a={_content_:a};for(let f=0;f<p;f++){const g=s.attributes[f].name;a[g]=s.attributes[f].value}}i[u]?(i[u]instanceof Array||(i[u]=[i[u]]),i[u].push(a)):i[u]=a}if(r){const s=new nt(i);n&&s.setGeometryName(n);const a=e.getAttribute("fid")||Tt(e,this.namespace,"id");return a&&s.setId(a),s}else return i}readFeatureElement(e,t){return this.readFeatureElementInternal(e,t,!0)}readPoint(e,t){const r=this.readFlatCoordinatesFromNode(e,t);if(r)return new it(r,"XYZ")}readMultiPoint(e,t){const r=P([],this.MULTIPOINT_PARSERS,e,t,this);if(r)return new st(r)}readMultiLineString(e,t){const r=P([],this.MULTILINESTRING_PARSERS,e,t,this);if(r)return new Ze(r)}readMultiPolygon(e,t){const r=P([],this.MULTIPOLYGON_PARSERS,e,t,this);if(r)return new Ye(r)}pointMemberParser(e,t){D(this.POINTMEMBER_PARSERS,e,t,this)}lineStringMemberParser(e,t){D(this.LINESTRINGMEMBER_PARSERS,e,t,this)}polygonMemberParser(e,t){D(this.POLYGONMEMBER_PARSERS,e,t,this)}readLineString(e,t){const r=this.readFlatCoordinatesFromNode(e,t);if(r)return new ze(r,"XYZ")}readFlatLinearRing(e,t){const r=P(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this);if(r)return r}readLinearRing(e,t){const r=this.readFlatCoordinatesFromNode(e,t);if(r)return new ot(r,"XYZ")}readPolygon(e,t){const r=P([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this);if(r&&r[0]){const n=r[0],i=[n.length];let s,a;for(s=1,a=r.length;s<a;++s)X(n,r[s]),i.push(n.length);return new $e(n,"XYZ",i)}else return}readFlatCoordinatesFromNode(e,t){return P(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}readGeometryFromNode(e,t){const r=this.readGeometryElement(e,[this.getReadOptions(e,t||{})]);return r||null}readFeaturesFromNode(e,t){const r={featureType:this.featureType,featureNS:this.featureNS};return r&&Object.assign(r,this.getReadOptions(e,t)),this.readFeaturesInternal(e,[r])||[]}readProjectionFromNode(e){return G(this.srsName?this.srsName:e.firstElementChild.getAttribute("srsName"))}}_.prototype.namespace=x;_.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}};_.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}};_.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}};_.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:h(_.prototype.pointMemberParser),pointMembers:h(_.prototype.pointMemberParser)}};_.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:h(_.prototype.lineStringMemberParser),lineStringMembers:h(_.prototype.lineStringMemberParser)}};_.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:h(_.prototype.polygonMemberParser),polygonMembers:h(_.prototype.polygonMemberParser)}};_.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:h(_.prototype.readFlatCoordinatesFromNode)}};_.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:h(_.prototype.readLineString)}};_.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:h(_.prototype.readPolygon)}};_.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:d(_.prototype.readFlatLinearRing)}};const w=_;function B(o){const e=q(o,!1);return z(e)}function z(o){const e=/^\s*(\d+)\s*$/.exec(o);if(e)return parseInt(e[1],10)}function C(o,e){o.appendChild(Qe().createTextNode(e))}const xt=x+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",vt={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class R extends w{constructor(e){e=e||{},super(e),this.FEATURE_COLLECTION_PARSERS[x].featureMember=h(this.readFeaturesInternal),this.schemaLocation=e.schemaLocation?e.schemaLocation:xt}readFlatCoordinates(e,t){const r=q(e,!1).replace(/^\s*|\s*$/g,""),i=t[0].srsName;let s="enu";if(i){const p=G(i);p&&(s=p.getAxisOrientation())}const a=r.trim().split(/\s+/),u=[];for(let p=0,f=a.length;p<f;p++){const g=a[p].split(/,+/),m=parseFloat(g[0]),N=parseFloat(g[1]),M=g.length===3?parseFloat(g[2]):0;s.substr(0,2)==="en"?u.push(m,N,M):u.push(N,m,M)}return u}readBox(e,t){const r=P([null],this.BOX_PARSERS_,e,t,this);return Ve(r[1][0],r[1][1],r[1][3],r[1][4])}innerBoundaryIsParser(e,t){const r=P(void 0,this.RING_PARSERS,e,t,this);r&&t[t.length-1].push(r)}outerBoundaryIsParser(e,t){const r=P(void 0,this.RING_PARSERS,e,t,this);if(r){const n=t[t.length-1];n[0]=r}}GEOMETRY_NODE_FACTORY_(e,t,r){const n=t[t.length-1],i=n.multiSurface,s=n.surface,a=n.multiCurve;return Array.isArray(e)?r="Envelope":(r=e.getType(),r==="MultiPolygon"&&i===!0?r="MultiSurface":r==="Polygon"&&s===!0?r="Surface":r==="MultiLineString"&&a===!0&&(r="MultiCurve")),y("http://www.opengis.net/gml",r)}writeFeatureElement(e,t,r){const n=t.getId();n&&e.setAttribute("fid",n);const i=r[r.length-1],s=i.featureNS,a=t.getGeometryName();i.serializers||(i.serializers={},i.serializers[s]={});const u=[],p=[];if(t.hasProperties()){const g=t.getProperties();for(const m in g){const N=g[m];N!==null&&(u.push(m),p.push(N),m==a||typeof N.getSimplifiedGeometry=="function"?m in i.serializers[s]||(i.serializers[s][m]=l(this.writeGeometryElement,this)):m in i.serializers[s]||(i.serializers[s][m]=l(C)))}}const f=Object.assign({},i);f.node=e,L(f,i.serializers,A(void 0,s),p,r,u)}writeCurveOrLineString(e,t,r){const i=r[r.length-1].srsName;if(e.nodeName!=="LineStringSegment"&&i&&e.setAttribute("srsName",i),e.nodeName==="LineString"||e.nodeName==="LineStringSegment"){const s=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(s),this.writeCoordinates_(s,t,r)}else if(e.nodeName==="Curve"){const s=y(e.namespaceURI,"segments");e.appendChild(s),this.writeCurveSegments_(s,t,r)}}writeLineStringOrCurveMember(e,t,r){const n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeCurveOrLineString(n,t,r))}writeMultiCurveOrLineString(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName,a=n.curve;s&&e.setAttribute("srsName",s);const u=t.getLineStrings();L({node:e,hasZ:i,srsName:s,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,u,r,void 0,this)}writeGeometryElement(e,t,r){const n=r[r.length-1],i=Object.assign({},n);i.node=e;let s;Array.isArray(t)?s=le(t,n):s=ue(t,!0,n),L(i,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[s],r,void 0,this)}createCoordinatesNode_(e){const t=y(e,"coordinates");return t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," "),t}writeCoordinates_(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName,a=t.getCoordinates(),u=a.length,p=new Array(u);for(let f=0;f<u;++f){const g=a[f];p[f]=this.getCoords_(g,s,i)}C(e,p.join(" "))}writeCurveSegments_(e,t,r){const n=y(e.namespaceURI,"LineStringSegment");e.appendChild(n),this.writeCurveOrLineString(n,t,r)}writeSurfaceOrPolygon(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName;if(e.nodeName!=="PolygonPatch"&&s&&e.setAttribute("srsName",s),e.nodeName==="Polygon"||e.nodeName==="PolygonPatch"){const a=t.getLinearRings();L({node:e,hasZ:i,srsName:s},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,r,void 0,this)}else if(e.nodeName==="Surface"){const a=y(e.namespaceURI,"patches");e.appendChild(a),this.writeSurfacePatches_(a,t,r)}}RING_NODE_FACTORY_(e,t,r){const n=t[t.length-1],i=n.node,s=n.exteriorWritten;return s===void 0&&(n.exteriorWritten=!0),y(i.namespaceURI,s!==void 0?"innerBoundaryIs":"outerBoundaryIs")}writeSurfacePatches_(e,t,r){const n=y(e.namespaceURI,"PolygonPatch");e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r)}writeRing(e,t,r){const n=y(e.namespaceURI,"LinearRing");e.appendChild(n),this.writeLinearRing(n,t,r)}getCoords_(e,t,r){let n="enu";t&&(n=G(t).getAxisOrientation());let i=n.substr(0,2)==="en"?e[0]+","+e[1]:e[1]+","+e[0];if(r){const s=e[2]||0;i+=","+s}return i}writePoint(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName;s&&e.setAttribute("srsName",s);const a=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(a);const u=t.getCoordinates(),p=this.getCoords_(u,s,i);C(a,p)}writeMultiPoint(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName;s&&e.setAttribute("srsName",s);const a=t.getPoints();L({node:e,hasZ:i,srsName:s},this.POINTMEMBER_SERIALIZERS,A("pointMember"),a,r,void 0,this)}writePointMember(e,t,r){const n=y(e.namespaceURI,"Point");e.appendChild(n),this.writePoint(n,t,r)}writeLinearRing(e,t,r){const i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);const s=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(s),this.writeCoordinates_(s,t,r)}writeMultiSurfaceOrPolygon(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName,a=n.surface;s&&e.setAttribute("srsName",s);const u=t.getPolygons();L({node:e,hasZ:i,srsName:s,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,u,r,void 0,this)}writeSurfaceOrPolygonMember(e,t,r){const n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r))}writeEnvelope(e,t,r){const i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);const s=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];L({node:e},this.ENVELOPE_SERIALIZERS,Ke,a,r,s,this)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(e,t,r){const n=t[t.length-1].node;return y("http://www.opengis.net/gml",vt[n.nodeName])}}R.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:d(R.prototype.readFlatCoordinates)}};R.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:R.prototype.innerBoundaryIsParser,outerBoundaryIs:R.prototype.outerBoundaryIsParser}};R.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:h(R.prototype.readFlatCoordinates)}};R.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:d(w.prototype.readPoint),MultiPoint:d(w.prototype.readMultiPoint),LineString:d(w.prototype.readLineString),MultiLineString:d(w.prototype.readMultiLineString),LinearRing:d(w.prototype.readLinearRing),Polygon:d(w.prototype.readPolygon),MultiPolygon:d(w.prototype.readMultiPolygon),Box:d(R.prototype.readBox)}};R.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:l(R.prototype.writeCurveOrLineString),MultiCurve:l(R.prototype.writeMultiCurveOrLineString),Point:l(R.prototype.writePoint),MultiPoint:l(R.prototype.writeMultiPoint),LineString:l(R.prototype.writeCurveOrLineString),MultiLineString:l(R.prototype.writeMultiCurveOrLineString),LinearRing:l(R.prototype.writeLinearRing),Polygon:l(R.prototype.writeSurfaceOrPolygon),MultiPolygon:l(R.prototype.writeMultiSurfaceOrPolygon),Surface:l(R.prototype.writeSurfaceOrPolygon),MultiSurface:l(R.prototype.writeMultiSurfaceOrPolygon),Envelope:l(R.prototype.writeEnvelope)}};R.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:l(R.prototype.writeLineStringOrCurveMember),curveMember:l(R.prototype.writeLineStringOrCurveMember)}};R.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:l(R.prototype.writeRing),innerBoundaryIs:l(R.prototype.writeRing)}};R.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:l(R.prototype.writePointMember)}};R.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:l(R.prototype.writeSurfaceOrPolygonMember),polygonMember:l(R.prototype.writeSurfaceOrPolygonMember)}};R.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:l(C),upperCorner:l(C)}};const W=R,Gt=x+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",Dt={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class c extends w{constructor(e){e=e||{},super(e),this.surface_=e.surface!==void 0?e.surface:!1,this.curve_=e.curve!==void 0?e.curve:!1,this.multiCurve_=e.multiCurve!==void 0?e.multiCurve:!0,this.multiSurface_=e.multiSurface!==void 0?e.multiSurface:!0,this.schemaLocation=e.schemaLocation?e.schemaLocation:Gt,this.hasZ=e.hasZ!==void 0?e.hasZ:!1}readMultiCurve(e,t){const r=P([],this.MULTICURVE_PARSERS,e,t,this);if(r)return new Ze(r)}readFlatCurveRing(e,t){const r=P([],this.MULTICURVE_PARSERS,e,t,this),n=[];for(let i=0,s=r.length;i<s;++i)X(n,r[i].getFlatCoordinates());return n}readMultiSurface(e,t){const r=P([],this.MULTISURFACE_PARSERS,e,t,this);if(r)return new Ye(r)}curveMemberParser(e,t){D(this.CURVEMEMBER_PARSERS,e,t,this)}surfaceMemberParser(e,t){D(this.SURFACEMEMBER_PARSERS,e,t,this)}readPatch(e,t){return P([null],this.PATCHES_PARSERS,e,t,this)}readSegment(e,t){return P([],this.SEGMENTS_PARSERS,e,t,this)}readPolygonPatch(e,t){return P([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this)}readLineStringSegment(e,t){return P([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}interiorParser(e,t){const r=P(void 0,this.RING_PARSERS,e,t,this);r&&t[t.length-1].push(r)}exteriorParser(e,t){const r=P(void 0,this.RING_PARSERS,e,t,this);if(r){const n=t[t.length-1];n[0]=r}}readSurface(e,t){const r=P([null],this.SURFACE_PARSERS,e,t,this);if(r&&r[0]){const n=r[0],i=[n.length];let s,a;for(s=1,a=r.length;s<a;++s)X(n,r[s]),i.push(n.length);return new $e(n,"XYZ",i)}else return}readCurve(e,t){const r=P([null],this.CURVE_PARSERS,e,t,this);if(r)return new ze(r,"XYZ")}readEnvelope(e,t){const r=P([null],this.ENVELOPE_PARSERS,e,t,this);return Ve(r[1][0],r[1][1],r[2][0],r[2][1])}readFlatPos(e,t){let r=q(e,!1);const n=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,i=[];let s;for(;s=n.exec(r);)i.push(parseFloat(s[1])),r=r.substr(s[0].length);if(r!=="")return;const u=t[0].srsName;let p="enu";if(u&&(p=G(u).getAxisOrientation()),p==="neu"){let g,m;for(g=0,m=i.length;g<m;g+=3){const N=i[g],M=i[g+1];i[g]=M,i[g+1]=N}}const f=i.length;if(f==2&&i.push(0),f!==0)return i}readFlatPosList(e,t){const r=q(e,!1).replace(/^\s*|\s*$/g,""),n=t[0],i=n.srsName,s=n.srsDimension;let a="enu";i&&(a=G(i).getAxisOrientation());const u=r.split(/\s+/);let p=2;e.getAttribute("srsDimension")?p=z(e.getAttribute("srsDimension")):e.getAttribute("dimension")?p=z(e.getAttribute("dimension")):e.parentNode.getAttribute("srsDimension")?p=z(e.parentNode.getAttribute("srsDimension")):s&&(p=z(s));let f,g,m;const N=[];for(let M=0,b=u.length;M<b;M+=p)f=parseFloat(u[M]),g=parseFloat(u[M+1]),m=p===3?parseFloat(u[M+2]):0,a.substr(0,2)==="en"?N.push(f,g,m):N.push(g,f,m);return N}writePos_(e,t,r){const n=r[r.length-1],i=n.hasZ,s=i?"3":"2";e.setAttribute("srsDimension",s);const a=n.srsName;let u="enu";a&&(u=G(a).getAxisOrientation());const p=t.getCoordinates();let f;if(u.substr(0,2)==="en"?f=p[0]+" "+p[1]:f=p[1]+" "+p[0],i){const g=p[2]||0;f+=" "+g}C(e,f)}getCoords_(e,t,r){let n="enu";t&&(n=G(t).getAxisOrientation());let i=n.substr(0,2)==="en"?e[0]+" "+e[1]:e[1]+" "+e[0];if(r){const s=e[2]||0;i+=" "+s}return i}writePosList_(e,t,r){const n=r[r.length-1],i=n.hasZ,s=i?"3":"2";e.setAttribute("srsDimension",s);const a=n.srsName,u=t.getCoordinates(),p=u.length,f=new Array(p);let g;for(let m=0;m<p;++m)g=u[m],f[m]=this.getCoords_(g,a,i);C(e,f.join(" "))}writePoint(e,t,r){const i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);const s=y(e.namespaceURI,"pos");e.appendChild(s),this.writePos_(s,t,r)}writeEnvelope(e,t,r){const i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);const s=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];L({node:e},this.ENVELOPE_SERIALIZERS,Ke,a,r,s,this)}writeLinearRing(e,t,r){const i=r[r.length-1].srsName;i&&e.setAttribute("srsName",i);const s=y(e.namespaceURI,"posList");e.appendChild(s),this.writePosList_(s,t,r)}RING_NODE_FACTORY_(e,t,r){const n=t[t.length-1],i=n.node,s=n.exteriorWritten;return s===void 0&&(n.exteriorWritten=!0),y(i.namespaceURI,s!==void 0?"interior":"exterior")}writeSurfaceOrPolygon(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName;if(e.nodeName!=="PolygonPatch"&&s&&e.setAttribute("srsName",s),e.nodeName==="Polygon"||e.nodeName==="PolygonPatch"){const a=t.getLinearRings();L({node:e,hasZ:i,srsName:s},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,r,void 0,this)}else if(e.nodeName==="Surface"){const a=y(e.namespaceURI,"patches");e.appendChild(a),this.writeSurfacePatches_(a,t,r)}}writeCurveOrLineString(e,t,r){const i=r[r.length-1].srsName;if(e.nodeName!=="LineStringSegment"&&i&&e.setAttribute("srsName",i),e.nodeName==="LineString"||e.nodeName==="LineStringSegment"){const s=y(e.namespaceURI,"posList");e.appendChild(s),this.writePosList_(s,t,r)}else if(e.nodeName==="Curve"){const s=y(e.namespaceURI,"segments");e.appendChild(s),this.writeCurveSegments_(s,t,r)}}writeMultiSurfaceOrPolygon(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName,a=n.surface;s&&e.setAttribute("srsName",s);const u=t.getPolygons();L({node:e,hasZ:i,srsName:s,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,u,r,void 0,this)}writeMultiPoint(e,t,r){const n=r[r.length-1],i=n.srsName,s=n.hasZ;i&&e.setAttribute("srsName",i);const a=t.getPoints();L({node:e,hasZ:s,srsName:i},this.POINTMEMBER_SERIALIZERS,A("pointMember"),a,r,void 0,this)}writeMultiCurveOrLineString(e,t,r){const n=r[r.length-1],i=n.hasZ,s=n.srsName,a=n.curve;s&&e.setAttribute("srsName",s);const u=t.getLineStrings();L({node:e,hasZ:i,srsName:s,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,u,r,void 0,this)}writeRing(e,t,r){const n=y(e.namespaceURI,"LinearRing");e.appendChild(n),this.writeLinearRing(n,t,r)}writeSurfaceOrPolygonMember(e,t,r){const n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r))}writePointMember(e,t,r){const n=y(e.namespaceURI,"Point");e.appendChild(n),this.writePoint(n,t,r)}writeLineStringOrCurveMember(e,t,r){const n=this.GEOMETRY_NODE_FACTORY_(t,r);n&&(e.appendChild(n),this.writeCurveOrLineString(n,t,r))}writeSurfacePatches_(e,t,r){const n=y(e.namespaceURI,"PolygonPatch");e.appendChild(n),this.writeSurfaceOrPolygon(n,t,r)}writeCurveSegments_(e,t,r){const n=y(e.namespaceURI,"LineStringSegment");e.appendChild(n),this.writeCurveOrLineString(n,t,r)}writeGeometryElement(e,t,r){const n=r[r.length-1],i=Object.assign({},n);i.node=e;let s;Array.isArray(t)?s=le(t,n):s=ue(t,!0,n),L(i,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[s],r,void 0,this)}writeFeatureElement(e,t,r){const n=t.getId();n&&e.setAttribute("fid",n);const i=r[r.length-1],s=i.featureNS,a=t.getGeometryName();i.serializers||(i.serializers={},i.serializers[s]={});const u=[],p=[];if(t.hasProperties()){const g=t.getProperties();for(const m in g){const N=g[m];N!==null&&(u.push(m),p.push(N),m==a||typeof N.getSimplifiedGeometry=="function"?m in i.serializers[s]||(i.serializers[s][m]=l(this.writeGeometryElement,this)):m in i.serializers[s]||(i.serializers[s][m]=l(C)))}}const f=Object.assign({},i);f.node=e,L(f,i.serializers,A(void 0,s),p,r,u)}writeFeatureMembers_(e,t,r){const n=r[r.length-1],i=n.featureType,s=n.featureNS,a={};a[s]={},a[s][i]=l(this.writeFeatureElement,this);const u=Object.assign({},n);u.node=e,L(u,a,A(i,s),t,r)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(e,t,r){const n=t[t.length-1].node;return y(this.namespace,Dt[n.nodeName])}GEOMETRY_NODE_FACTORY_(e,t,r){const n=t[t.length-1],i=n.multiSurface,s=n.surface,a=n.curve,u=n.multiCurve;return Array.isArray(e)?r="Envelope":(r=e.getType(),r==="MultiPolygon"&&i===!0?r="MultiSurface":r==="Polygon"&&s===!0?r="Surface":r==="LineString"&&a===!0?r="Curve":r==="MultiLineString"&&u===!0&&(r="MultiCurve")),y(this.namespace,r)}writeGeometryNode(e,t){t=this.adaptOptions(t);const r=y(this.namespace,"geom"),n={node:r,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return t&&Object.assign(n,t),this.writeGeometryElement(r,e,[n]),r}writeFeaturesNode(e,t){t=this.adaptOptions(t);const r=y(this.namespace,"featureMembers");r.setAttributeNS(oe,"xsi:schemaLocation",this.schemaLocation);const n={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return t&&Object.assign(n,t),this.writeFeatureMembers_(r,e,[n]),r}}c.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:d(c.prototype.readFlatPos),posList:d(c.prototype.readFlatPosList),coordinates:d(W.prototype.readFlatCoordinates)}};c.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:c.prototype.interiorParser,exterior:c.prototype.exteriorParser}};c.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:d(w.prototype.readPoint),MultiPoint:d(w.prototype.readMultiPoint),LineString:d(w.prototype.readLineString),MultiLineString:d(w.prototype.readMultiLineString),LinearRing:d(w.prototype.readLinearRing),Polygon:d(w.prototype.readPolygon),MultiPolygon:d(w.prototype.readMultiPolygon),Surface:d(c.prototype.readSurface),MultiSurface:d(c.prototype.readMultiSurface),Curve:d(c.prototype.readCurve),MultiCurve:d(c.prototype.readMultiCurve),Envelope:d(c.prototype.readEnvelope)}};c.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:h(c.prototype.curveMemberParser),curveMembers:h(c.prototype.curveMemberParser)}};c.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:h(c.prototype.surfaceMemberParser),surfaceMembers:h(c.prototype.surfaceMemberParser)}};c.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:h(w.prototype.readLineString),Curve:h(c.prototype.readCurve)}};c.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:h(w.prototype.readPolygon),Surface:h(c.prototype.readSurface)}};c.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:d(c.prototype.readPatch)}};c.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:d(c.prototype.readSegment)}};c.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:h(c.prototype.readFlatPosList),upperCorner:h(c.prototype.readFlatPosList)}};c.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:d(c.prototype.readPolygonPatch)}};c.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:He(c.prototype.readLineStringSegment)}};w.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:d(w.prototype.readFlatLinearRing),Ring:d(c.prototype.readFlatCurveRing)}};c.prototype.writeFeatures;c.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:l(c.prototype.writeRing),interior:l(c.prototype.writeRing)}};c.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:l(C),upperCorner:l(C)}};c.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:l(c.prototype.writeSurfaceOrPolygonMember),polygonMember:l(c.prototype.writeSurfaceOrPolygonMember)}};c.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:l(c.prototype.writePointMember)}};c.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:l(c.prototype.writeLineStringOrCurveMember),curveMember:l(c.prototype.writeLineStringOrCurveMember)}};c.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:l(c.prototype.writeCurveOrLineString),MultiCurve:l(c.prototype.writeMultiCurveOrLineString),Point:l(c.prototype.writePoint),MultiPoint:l(c.prototype.writeMultiPoint),LineString:l(c.prototype.writeCurveOrLineString),MultiLineString:l(c.prototype.writeMultiCurveOrLineString),LinearRing:l(c.prototype.writeLinearRing),Polygon:l(c.prototype.writeSurfaceOrPolygon),MultiPolygon:l(c.prototype.writeMultiSurfaceOrPolygon),Surface:l(c.prototype.writeSurfaceOrPolygon),MultiSurface:l(c.prototype.writeMultiSurfaceOrPolygon),Envelope:l(c.prototype.writeEnvelope)}};const E=c;class S extends E{constructor(e){e=e||{},super(e),this.schemaLocation=e.schemaLocation?e.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}}S.prototype.namespace="http://www.opengis.net/gml/3.2";S.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:d(E.prototype.readFlatPos),posList:d(E.prototype.readFlatPosList),coordinates:d(W.prototype.readFlatCoordinates)}};S.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:E.prototype.interiorParser,exterior:E.prototype.exteriorParser}};S.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:d(w.prototype.readPoint),MultiPoint:d(w.prototype.readMultiPoint),LineString:d(w.prototype.readLineString),MultiLineString:d(w.prototype.readMultiLineString),LinearRing:d(w.prototype.readLinearRing),Polygon:d(w.prototype.readPolygon),MultiPolygon:d(w.prototype.readMultiPolygon),Surface:d(S.prototype.readSurface),MultiSurface:d(E.prototype.readMultiSurface),Curve:d(S.prototype.readCurve),MultiCurve:d(E.prototype.readMultiCurve),Envelope:d(S.prototype.readEnvelope)}};S.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:h(E.prototype.curveMemberParser),curveMembers:h(E.prototype.curveMemberParser)}};S.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:h(E.prototype.surfaceMemberParser),surfaceMembers:h(E.prototype.surfaceMemberParser)}};S.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:h(w.prototype.readLineString),Curve:h(E.prototype.readCurve)}};S.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:h(w.prototype.readPolygon),Surface:h(E.prototype.readSurface)}};S.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:d(E.prototype.readPatch)}};S.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:d(E.prototype.readSegment)}};S.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:h(E.prototype.readFlatPosList),upperCorner:h(E.prototype.readFlatPosList)}};S.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:d(E.prototype.readPolygonPatch)}};S.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:He(E.prototype.readLineStringSegment)}};S.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:h(w.prototype.pointMemberParser),pointMembers:h(w.prototype.pointMemberParser)}};S.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:h(w.prototype.lineStringMemberParser),lineStringMembers:h(w.prototype.lineStringMemberParser)}};S.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:h(w.prototype.polygonMemberParser),polygonMembers:h(w.prototype.polygonMemberParser)}};S.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:h(w.prototype.readFlatCoordinatesFromNode)}};S.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:h(w.prototype.readLineString)}};S.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:h(w.prototype.readPolygon)}};S.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:d(w.prototype.readFlatLinearRing),Ring:d(S.prototype.readFlatCurveRing)}};S.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:l(E.prototype.writeRing),interior:l(E.prototype.writeRing)}};S.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:l(C),upperCorner:l(C)}};S.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:l(E.prototype.writeSurfaceOrPolygonMember),polygonMember:l(E.prototype.writeSurfaceOrPolygonMember)}};S.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:l(E.prototype.writePointMember)}};S.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:l(E.prototype.writeLineStringOrCurveMember),curveMember:l(E.prototype.writeLineStringOrCurveMember)}};S.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:l(E.prototype.writeCurveOrLineString),MultiCurve:l(E.prototype.writeMultiCurveOrLineString),Point:l(S.prototype.writePoint),MultiPoint:l(E.prototype.writeMultiPoint),LineString:l(E.prototype.writeCurveOrLineString),MultiLineString:l(E.prototype.writeMultiCurveOrLineString),LinearRing:l(E.prototype.writeLinearRing),Polygon:l(E.prototype.writeSurfaceOrPolygon),MultiPolygon:l(E.prototype.writeMultiSurfaceOrPolygon),Surface:l(E.prototype.writeSurfaceOrPolygon),MultiSurface:l(E.prototype.writeMultiSurfaceOrPolygon),Envelope:l(E.prototype.writeEnvelope)}};const ce=S,Re={"http://www.opengis.net/gml":{boundedBy:I(w.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:h(w.prototype.readFeaturesInternal)}},Ut={"http://www.opengis.net/wfs":{totalInserted:I(B),totalUpdated:I(B),totalDeleted:I(B)},"http://www.opengis.net/wfs/2.0":{totalInserted:I(B),totalUpdated:I(B),totalDeleted:I(B)}},Bt={"http://www.opengis.net/wfs":{TransactionSummary:I(Pe,"transactionSummary"),InsertResults:I(Me,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:I(Pe,"transactionSummary"),InsertResults:I(Me,"insertIds")}},Zt={"http://www.opengis.net/wfs":{PropertyName:l(C)},"http://www.opengis.net/wfs/2.0":{PropertyName:l(C)}},ke={"http://www.opengis.net/wfs":{Insert:l(Le),Update:l(Ce),Delete:l(_e),Property:l(Ae),Native:l(Te)},"http://www.opengis.net/wfs/2.0":{Insert:l(Le),Update:l(Ce),Delete:l(_e),Property:l(Ae),Native:l(Te)}},je="feature",de="http://www.w3.org/2000/xmlns/",me={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},ae={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},ge={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},Se={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},fe={"2.0.0":ce,"1.1.0":E,"1.0.0":W},Yt="1.1.0";class zt extends Je{constructor(e){super(),e=e||{},this.version_=e.version?e.version:Yt,this.featureType_=e.featureType,this.featureNS_=e.featureNS,this.gmlFormat_=e.gmlFormat?e.gmlFormat:new fe[this.version_],this.schemaLocation_=e.schemaLocation?e.schemaLocation:Se[this.version_]}getFeatureType(){return this.featureType_}setFeatureType(e){this.featureType_=e}readFeaturesFromNode(e,t){const r={node:e};Object.assign(r,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(r,this.getReadOptions(e,t||{}));const n=[r];let i;this.version_==="2.0.0"?i=Re:i=this.gmlFormat_.FEATURE_COLLECTION_PARSERS;let s=P([],i,e,n,this.gmlFormat_);return s||(s=[]),s}readTransactionResponse(e){if(e)if(typeof e=="string"){const t=Y(e);return this.readTransactionResponseFromDocument(t)}else return Z(e)?this.readTransactionResponseFromDocument(e):this.readTransactionResponseFromNode(e);else return}readFeatureCollectionMetadata(e){if(e)if(typeof e=="string"){const t=Y(e);return this.readFeatureCollectionMetadataFromDocument(t)}else return Z(e)?this.readFeatureCollectionMetadataFromDocument(e):this.readFeatureCollectionMetadataFromNode(e);else return}readFeatureCollectionMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t)}readFeatureCollectionMetadataFromNode(e){const t={},r=z(e.getAttribute("numberOfFeatures"));return t.numberOfFeatures=r,P(t,Re,e,[],this.gmlFormat_)}readTransactionResponseFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t)}readTransactionResponseFromNode(e){return P({},Bt,e,[])}writeGetFeature(e){const t=y(ae[this.version_],"GetFeature");t.setAttribute("service","WFS"),t.setAttribute("version",this.version_),e.handle&&t.setAttribute("handle",e.handle),e.outputFormat&&t.setAttribute("outputFormat",e.outputFormat),e.maxFeatures!==void 0&&t.setAttribute("maxFeatures",String(e.maxFeatures)),e.resultType&&t.setAttribute("resultType",e.resultType),e.startIndex!==void 0&&t.setAttribute("startIndex",String(e.startIndex)),e.count!==void 0&&t.setAttribute("count",String(e.count)),e.viewParams!==void 0&&t.setAttribute("viewParams",e.viewParams),t.setAttributeNS(oe,"xsi:schemaLocation",this.schemaLocation_);const r={node:t};if(Object.assign(r,{version:this.version_,srsName:e.srsName,featureNS:e.featureNS?e.featureNS:this.featureNS_,featurePrefix:e.featurePrefix,propertyNames:e.propertyNames?e.propertyNames:[]}),V(Array.isArray(e.featureTypes),11),typeof e.featureTypes[0]=="string"){let n=e.filter;e.bbox&&(V(e.geometryName,12),n=this.combineBboxAndFilter(e.geometryName,e.bbox,e.srsName,n)),Object.assign(r,{geometryName:e.geometryName,filter:n}),Be(t,e.featureTypes,[r])}else e.featureTypes.forEach(n=>{const i=this.combineBboxAndFilter(n.geometryName,n.bbox,e.srsName,e.filter);Object.assign(r,{geometryName:n.geometryName,filter:i}),Be(t,[n.name],[r])});return t}combineBboxAndFilter(e,t,r,n){const i=Ct(e,t,r);return n?qe(n,i):i}writeTransaction(e,t,r,n){const i=[],s=n.version?n.version:this.version_,a=y(ae[s],"Transaction");a.setAttribute("service","WFS"),a.setAttribute("version",s);let u;n&&(u=n.gmlOptions?n.gmlOptions:{},n.handle&&a.setAttribute("handle",n.handle)),a.setAttributeNS(oe,"xsi:schemaLocation",Se[s]);const p=$t(a,u,s,n);return e&&Q("Insert",e,i,p),t&&Q("Update",t,i,p),r&&Q("Delete",r,i,p),n.nativeElements&&Q("Native",n.nativeElements,i,p),a}readProjectionFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null}readProjectionFromNode(e){if(e.firstElementChild&&e.firstElementChild.firstElementChild){e=e.firstElementChild.firstElementChild;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(!(t.childNodes.length===0||t.childNodes.length===1&&t.firstChild.nodeType===3)){const r=[{}];return this.gmlFormat_.readGeometryElement(t,r),G(r.pop().srsName)}}return null}}function $t(o,e,t,r){const n=r.featurePrefix?r.featurePrefix:je;let i;return t==="1.0.0"?i=2:t==="1.1.0"?i=3:t==="2.0.0"&&(i=3.2),Object.assign({node:o},{version:t,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:n,gmlVersion:i,hasZ:r.hasZ,srsName:r.srsName},e)}function Q(o,e,t,r){L(r,ke,A(o),e,t)}function Pe(o,e){return P({},Ut,o,e)}const Vt={"http://www.opengis.net/ogc":{FeatureId:h(function(o,e){return o.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:h(function(o,e){return o.getAttribute("fid")})}};function Ne(o,e){D(Vt,o,e)}const Xt={"http://www.opengis.net/wfs":{Feature:Ne},"http://www.opengis.net/wfs/2.0":{Feature:Ne}};function Me(o,e){return P([],Xt,o,e)}function Le(o,e,t){const r=t[t.length-1],n=r.featureType,i=r.featureNS,s=r.gmlVersion,a=y(i,n);o.appendChild(a),s===2?W.prototype.writeFeatureElement(a,e,t):s===3?E.prototype.writeFeatureElement(a,e,t):ce.prototype.writeFeatureElement(a,e,t)}function et(o,e,t){const n=t[t.length-1].version,i=me[n],s=y(i,"Filter"),a=y(i,"FeatureId");s.appendChild(a),a.setAttribute("fid",e),o.appendChild(s)}function he(o,e){o=o||je;const t=o+":";return e.startsWith(t)?e:t+e}function _e(o,e,t){const r=t[t.length-1];V(e.getId()!==void 0,26);const n=r.featureType,i=r.featurePrefix,s=r.featureNS,a=he(i,n);o.setAttribute("typeName",a),o.setAttributeNS(de,"xmlns:"+i,s);const u=e.getId();u!==void 0&&et(o,u,t)}function Ce(o,e,t){const r=t[t.length-1];V(e.getId()!==void 0,27);const n=r.version,i=r.featureType,s=r.featurePrefix,a=r.featureNS,u=he(s,i),p=e.getGeometryName();o.setAttribute("typeName",u),o.setAttributeNS(de,"xmlns:"+s,a);const f=e.getId();if(f!==void 0){const g=e.getKeys(),m=[];for(let N=0,M=g.length;N<M;N++){const b=e.get(g[N]);if(b!==void 0){let O=g[N];b&&typeof b.getSimplifiedGeometry=="function"&&(O=p),m.push({name:O,value:b})}}L({version:n,gmlVersion:r.gmlVersion,node:o,hasZ:r.hasZ,srsName:r.srsName},ke,A("Property"),m,t),et(o,f,t)}}function Ae(o,e,t){const r=t[t.length-1],n=r.version,i=ae[n],s=y(i,"Name"),a=r.gmlVersion;if(o.appendChild(s),C(s,e.name),e.value!==void 0&&e.value!==null){const u=y(i,"Value");o.appendChild(u),e.value&&typeof e.value.getSimplifiedGeometry=="function"?a===2?W.prototype.writeGeometryElement(u,e.value,t):a===3?E.prototype.writeGeometryElement(u,e.value,t):ce.prototype.writeGeometryElement(u,e.value,t):C(u,e.value)}}function Te(o,e,t){e.vendorId&&o.setAttribute("vendorId",e.vendorId),e.safeToIgnore!==void 0&&o.setAttribute("safeToIgnore",String(e.safeToIgnore)),e.value!==void 0&&C(o,e.value)}const te={"http://www.opengis.net/wfs":{Query:l(be)},"http://www.opengis.net/wfs/2.0":{Query:l(be)},"http://www.opengis.net/ogc":{During:l(Fe),And:l(J),Or:l(J),Not:l(xe),BBOX:l(Ie),Contains:l(v),Intersects:l(v),Within:l(v),DWithin:l(Oe),PropertyIsEqualTo:l(T),PropertyIsNotEqualTo:l(T),PropertyIsLessThan:l(T),PropertyIsLessThanOrEqualTo:l(T),PropertyIsGreaterThan:l(T),PropertyIsGreaterThanOrEqualTo:l(T),PropertyIsNull:l(ve),PropertyIsBetween:l(Ge),PropertyIsLike:l(De)},"http://www.opengis.net/fes/2.0":{During:l(Fe),And:l(J),Or:l(J),Not:l(xe),BBOX:l(Ie),Contains:l(v),Disjoint:l(v),Intersects:l(v),ResourceId:l(Wt),Within:l(v),DWithin:l(Oe),PropertyIsEqualTo:l(T),PropertyIsNotEqualTo:l(T),PropertyIsLessThan:l(T),PropertyIsLessThanOrEqualTo:l(T),PropertyIsGreaterThan:l(T),PropertyIsGreaterThanOrEqualTo:l(T),PropertyIsNull:l(ve),PropertyIsBetween:l(Ge),PropertyIsLike:l(De)}};function be(o,e,t){const r=t[t.length-1],n=r.version,i=r.featurePrefix,s=r.featureNS,a=r.propertyNames,u=r.srsName;let p;i?p=he(i,e):p=e;let f;n==="2.0.0"?f="typeNames":f="typeName",o.setAttribute(f,p),u&&o.setAttribute("srsName",u),s&&o.setAttributeNS(de,"xmlns:"+i,s);const g=Object.assign({},r);g.node=o,L(g,Zt,A("PropertyName"),a,t);const m=r.filter;if(m){const N=y(re(n),"Filter");o.appendChild(N),qt(N,m,t)}}function qt(o,e,t){const r=t[t.length-1],n={node:o};Object.assign(n,{context:r}),L(n,te,A(e.getTagName()),[e],t)}function Ie(o,e,t){const r=t[t.length-1],i=r.context.version;r.srsName=e.srsName;const s=fe[i];$(i,o,e.geometryName),s.prototype.writeGeometryElement(o,e.extent,t)}function Wt(o,e,t){o.setAttribute("rid",e.rid)}function v(o,e,t){const r=t[t.length-1],i=r.context.version;r.srsName=e.srsName;const s=fe[i];$(i,o,e.geometryName),s.prototype.writeGeometryElement(o,e.geometry,t)}function Oe(o,e,t){const i=t[t.length-1].context.version;v(o,e,t);const s=y(re(i),"Distance");C(s,e.distance.toString()),i==="2.0.0"?s.setAttribute("uom",e.unit):s.setAttribute("units",e.unit),o.appendChild(s)}function Fe(o,e,t){const i=t[t.length-1].context.version;j(ge[i],"ValueReference",o,e.propertyName);const s=y(x,"TimePeriod");o.appendChild(s);const a=y(x,"begin");s.appendChild(a),Ue(a,e.begin);const u=y(x,"end");s.appendChild(u),Ue(u,e.end)}function J(o,e,t){const n=t[t.length-1].context,i={node:o};Object.assign(i,{context:n});const s=e.conditions;for(let a=0,u=s.length;a<u;++a){const p=s[a];L(i,te,A(p.getTagName()),[p],t)}}function xe(o,e,t){const n=t[t.length-1].context,i={node:o};Object.assign(i,{context:n});const s=e.condition;L(i,te,A(s.getTagName()),[s],t)}function T(o,e,t){const i=t[t.length-1].context.version;e.matchCase!==void 0&&o.setAttribute("matchCase",e.matchCase.toString()),$(i,o,e.propertyName),ee(i,o,""+e.expression)}function ve(o,e,t){const i=t[t.length-1].context.version;$(i,o,e.propertyName)}function Ge(o,e,t){const i=t[t.length-1].context.version,s=re(i);$(i,o,e.propertyName);const a=y(s,"LowerBoundary");o.appendChild(a),ee(i,a,""+e.lowerBoundary);const u=y(s,"UpperBoundary");o.appendChild(u),ee(i,u,""+e.upperBoundary)}function De(o,e,t){const i=t[t.length-1].context.version;o.setAttribute("wildCard",e.wildCard),o.setAttribute("singleChar",e.singleChar),o.setAttribute("escapeChar",e.escapeChar),e.matchCase!==void 0&&o.setAttribute("matchCase",e.matchCase.toString()),$(i,o,e.propertyName),ee(i,o,""+e.pattern)}function j(o,e,t,r){const n=y(o,e);C(n,r),t.appendChild(n)}function ee(o,e,t){j(re(o),"Literal",e,t)}function $(o,e,t){o==="2.0.0"?j(ge[o],"ValueReference",e,t):j(me[o],"PropertyName",e,t)}function Ue(o,e){const t=y(x,"TimeInstant");o.appendChild(t);const r=y(x,"timePosition");t.appendChild(r),C(r,e)}function Be(o,e,t){const r=t[t.length-1],n=Object.assign({},r);n.node=o,L(n,te,A("Query"),e,t)}function re(o){let e;return o==="2.0.0"?e=ge[o]:e=me[o],e}const Ht=zt,se=o=>{const e=o.match(/"([^"]+)"='([^']+)'/);return At(e[1],e[2])};var Kt=(o,e)=>{const r=k.getLayers().getArray().find(a=>a.get("name")===o).getSource().getParams().LAYERS,n=ut(k.getLayers().getArray().find(a=>a.get("name")===o).getSource().url_);let i={srsName:"EPSG:3857",featurePrefix:"geonode",featureTypes:[r],outputFormat:"application/json"};if(e&&typeof e=="string"&&e.trim()!==""){let a;if(e.includes(" AND "))a=e.split(" AND ").map(se),i.filter=qe(...a);else if(e.includes(" OR "))a=e.split(" OR ").map(se),i.filter=_t(...a);else{const u=se(e);i.filter=u}}console.warn("Options are ",i);const s=new Ht().writeGetFeature(i);return fetch(`${n}wfs`,{method:"POST",body:new XMLSerializer().serializeToString(s),headers:{"Content-Type":"text/xml"}}).then(a=>a.json())};const Qt=()=>{const o=`
      <div class="mx-1  order-2">
      <button
        type="button" 
        class="btn btn-danger btn-sm btn-circle" 
        id="attributeTableBtn" 
        x-tooltip.placement.left="'Attribute table'"
        @click="$store.attributeTable.process_attribute_table()"
        :class="$store.attributeTable.componentIsActive ? 'bg-danger' : 'btn-light'">
        <i data-feather="list" class="size-16"></i>

      </button>
    </div>
      `;var e=document.getElementById("rightMiddleSlot");e.insertAdjacentHTML("beforeend",o);const t=`
    <div id="attributeTable" class="position-absolute bottom-0 end-0 p-0 bg-white border-top px-1" style="width: 100%; height: 40vh; z-index:1000" x-show="$store.attributeTable.componentIsActive">
      <div class="offcanvas-header d-flex justify-content-between align-items-center px-3 mt-3">
          <div class="d-flex align-items-center">
              <!-- Layer Selection -->
              <div class="layer-select-container me-2">
                  <select id="layerSelect" class="form-select form-select-sm">
                      <template x-for="option in $store.attributeTable.visisbleLayers"> 
                          <option :value="option.get('name')" x-text="option.get('name')"></option>
                      </template>
                  </select>
              </div>
              <!-- Row Count Selection -->
              <div class="ms-2"> 
                  <select x-model="$store.attributeTable.rowCount" class="form-select form-select-sm" id="rowCountSelect">
                      <option value="5">5</option>
                      <option value="10">10</option>
                      <option value="50">50</option>
                  </select>
              </div>
          </div>

          <div class="d-flex align-items-center">
              <!-- Items Shown Indicator -->
              <p class="mb-0 mx-3" x-text="$store.attributeTable.filteredFeatures().length + ' items shown'"></p>
           
              <!-- Search Input -->
              <div class="d-flex me-2">
                  <label for="searchInput" class="me-2 mb-0"><i class="bi bi-search"></i></label>
                  <input type="text" id="searchInput" class="form-control form-control-sm" placeholder="Search..." x-model="$store.attributeTable.searchQuery" style="width: 200px;">
              </div>

              <!-- Close Button -->
              <button type="button" class="btn-close" aria-label="Close" @click="$store.attributeTable.closePanel()"></button>
          </div>
      </div>

            <div class="offcanvas-body mt-4 px-3" id="attributeTableBody">

              <!-- table -->
              <div style="width: 100%; overflow-y: auto;">

              <!-- Alpine.js Component for Feature Properties Table -->
              <div x-cloak>
                <template x-if="!$store.attributeTable.fetchSuccessful">
                  <p>Sorry, no items received.</p>
                </template>

                <template x-if="$store.attributeTable.fetchSuccessful">
                  <table class="attributesTable table table-sm table-striped mb-0" id="attributesTable">
                    <thead>
                        <tr>
                          <th>
                            <span class="attributTable_col" x-text="''"></span>
                          </th>
                          <template x-if="$store.attributeTable.features.length > 0">
                            <template x-for="key in Object.keys($store.attributeTable.features[0].properties)" :key="key">
                              <th>
                                <span class="attributTable_col" x-text="$store.attributeTable.getKeyTranslation(key)"></span>
                              </th>
                            </template>
                          </template>
                        </tr>
                      </thead>
                      <tbody>
                          <template x-for="feature in $store.attributeTable.paginatedFeatures()" :key="feature.id">
                          <tr :class="$store.attributeTable.activeFeatures.includes(String(feature.properties['fid'])) ? 'highlight-row' : ''">
                            <td>
                            <p x-show="!$store.attributeTable.activeFeatures.includes(String(feature.properties['fid']))">
                              <a href="#" :data-id="feature.properties['fid']" @click="$store.attributeTable.zoomTo()" >
                                  <i data-feather="map-pin" class="size-16"></i>
                              </a>      
                            </p>

                            <p x-show="$store.attributeTable.activeFeatures.includes(String(feature.properties['fid']))">
                              <a href="#" :data-id="feature.properties['fid']" @click="$store.attributeTable.zoomTo()" >
                                <i data-feather="check" class="size-16"></i>
                              </a>      
                            </p>

                            </td>
                            <template x-for="[key, value] in Object.entries(feature.properties)" :key="key">
                              <td class="attributTableTD">
                                <span class="attributTable_col" x-html="$store.attributeTable.decorateValue(value)"> </span>
                              </td>
                            </template>
                          </tr>
                        </template>
                      </tbody>
                  </table>
                </template>
                
              </div>


            
            </div>
            <!-- Pagination -->
            <template x-if="$store.attributeTable.fetchSuccessful">

              <nav aria-label="Page navigation">
                <ul class="pagination pagination-sm justify-content-end mt-3">
                  <!-- First Page Link -->
                  <li class="page-item" :class="{ disabled: $store.attributeTable.currentPage === 1 }">
                    <a class="page-link" href="#" @click.prevent="$store.attributeTable.setFirstPage()">
                      First
                    </a>
                  </li>
              
                  <!-- Dynamic Page Links -->
                  <template x-for="page in $store.attributeTable.pageRange()" :key="page">
                    <li class="page-item" :class="{ active: $store.attributeTable.currentPage === page }">
                      <a class="page-link" href="#" x-text="page" @click.prevent="$store.attributeTable.setPage(page)">
                      </a>
                    </li>
                  </template>
              
                  <!-- Last Page Link -->
                  <li class="page-item" :class="{ disabled: $store.attributeTable.currentPage === $store.attributeTable.totalPages() }">
                    <a class="page-link" href="#" @click.prevent="$store.attributeTable.setLastPage()">
                      Last
                    </a>
                  </li>
                </ul>
              </nav>
              </template>
    </div>
  </div>

  `;var r=document.getElementById("map");r.insertAdjacentHTML("afterend",t)},er=()=>{F.store("attributeTable",{componentIsActive:!1,visisbleLayers:[],features:[],filterString:"",activeFeatures:[],isValidUrl:function(e){return at(e)},zoomToCoordinates:[],closePanel:function(){U("deleteMapPins",{}),this.componentIsActive=!1,this.activeFeatures=[],this.zoomToCoordinates=[],F.store("pluginStatus").mapClickEnabled=!0},zoomTo:function(){const e=event.target.closest("a").getAttribute("data-id"),t=this.features.find(r=>r.properties.fid==e);if(t){const r=t.geometry;let n,i;switch(this.activeFeatures.includes(e)?this.activeFeatures=this.activeFeatures.filter(function(s){return s!==e}):this.activeFeatures.push(e),r.type){case"Point":i=r.coordinates;const s=100;n=[r.coordinates[0]-s,r.coordinates[1]-s,r.coordinates[0]+s,r.coordinates[1]+s];break;case"Polygon":n=H(r.coordinates[0].flat()),i=K(n);break;case"MultiPolygon":const a=r.coordinates.flat(2);n=H(a),i=K(n);break;case"LineString":n=H(r.coordinates),i=K(n);break;case"MultiLineString":const u=r.coordinates.flat();n=H(u),i=K(n);break;default:console.error("Unsupported geometry type:",r.type);return}if(n){const s=this.zoomToCoordinates.findIndex(a=>a[0]===i[0]&&a[1]===i[1]);s===-1?this.zoomToCoordinates.push([i[0],i[1]]):this.zoomToCoordinates.splice(s,1),U("deleteMapPins",{}),U("addMapPins",{pin_coordinates:this.zoomToCoordinates,fitView:!0,moveCenterLeft:!1,bottomPadding:"40vh"})}}},searchQuery:"",rowCount:5,currentPage:1,fetchSuccessful:!1,decorateValue:function(e){return pt(e,["createLinkForUrl","decodeUrl","harmonizeUnknown","replaceBulletwithComma","replaceUndefined","replaceDatingMethod","unknownLowerCase"])},blockedKeys:["c_b_t_bc_rel","svgid","c_bones","bone_relations","age","adults","subadults","c_no_o_bones","published","gaz_link","gazid","owner","is_approved","text"],keyTranslations:{disease:"Disease",sex:"Sex",sex_freetext:"Methods for sex determination",age:"Age",age_class:"Age class",age_estimation_method:"Methods for age estimation",age_freetext:"Estimated age",adults:"Adults",size_from:"Body height from (cm)",size_to:"Body height to (cm)",size_freetext:"Methods for body height calculation",chronology:"Time period",chronology_freetext:"Time period comment",dating_method:"Dating method",subadults:"Subadults",c_no_o_bones:"Amount of bones",c_technic:"Used technique",doi:"Doi",differential_diagnosis:"Differential Diagnosis",dna_analyses:"aDNA analyses",dna_analyses_link:"DNA analyses",storage_place:"Storage place",storage_place_freetext:"Storage place freetext",archaeological_burial_type:"Archaeological burial type",archaeological_funery_context:"Archaeological funerary context",archaeological_individualid:"Archaeological individual ID",archaeological_tombid:"Archaeological tomb ID",gaz_link:"iDAI.gazetteer link",gazid:"iDAI.gazetteer ID",site:"Site",origin:"Origin",reference_images:"Reference images",references:"References",uuid:"UUID",owner:"Owner",fid:"Datbase ID",comment:"Comment",fid:"File ID",uid:"UUID"},getKeyTranslation:function(e){return this.keyTranslations[e]||e},filteredFeatures:function(){ct.replace();const e=this.searchQuery.toLowerCase(),t=this.features.filter(r=>Object.entries(r.properties).some(([n,i])=>typeof i=="string"||typeof i=="number"?i.toString().toLowerCase().includes(e):!1));return F.store("geonodeCustomLayerFilter").layerFeaturesOnMap["Daard Database"]=t.length,t},paginatedFeatures:function(){const e=(this.currentPage-1)*this.rowCount,t=e+Number(this.rowCount),r=this.filteredFeatures().slice(e,t);return console.log(`Paginated Features: Current Page = ${this.currentPage}, Row Count = ${this.rowCount}, Start = ${e}, End = ${t}, Count = ${r.length}`),r},totalPages:function(){const e=this.filteredFeatures().length;return Math.ceil(e/this.rowCount)},setPage:function(e){this.currentPage=e},pageRange:function(){const t=Math.max(1,this.currentPage-2),r=Math.min(this.totalPages(),this.currentPage+2);let n=[];for(let i=t;i<=r;i++)n.push(i);return n},setFirstPage:function(){this.currentPage=1},setLastPage:function(){this.currentPage=this.totalPages()},setPage:function(e){this.currentPage=e,console.log(`Set Page: Current Page Set to = ${e}`)},process_attribute_table:function(){F.store("pluginStatus").closeAllOffcanvas("attributeTable"),this.componentIsActive=!this.componentIsActive,F.store("pluginStatus").mapClickEnabled=!this.componentIsActive,this.populateLayerSelect()},populateLayerSelect:function(){const e=k.getLayers().getArray().filter(t=>t.getVisible());this.visisbleLayers=e,e.length>0&&(this.selectedLayer=e[0].get("name"),this.updateTableForLayer(this.selectedLayer))},updateRowCount:function(){this.currentPage=1,console.log(`Row Count Updated: New Row Count = ${this.rowCount}, Current Page Reset to = ${this.currentPage}`)},updateTableForLayer:function(e=null){console.log("updating with: ",this.filterString),this.currentTable=!0;const t=e||document.getElementById("layerSelect").value;k.getLayers().getArray().find(r=>r.get("name")===t),this.activeFeatures=[],this.zoomToCoordinates=[],U("deleteMapPins",{}),U("showLoading",{}),Kt(t,this.filterString).then(r=>{if(r&&r.features){const n=Object.keys(this.keyTranslations),i=r.features.map(s=>{const a=Object.keys(s.properties).filter(p=>!this.blockedKeys.includes(p)).sort((p,f)=>{const g=n.indexOf(p),m=n.indexOf(f);return(g!==-1?g:1/0)-(m!==-1?m:1/0)}),u={};return a.forEach(p=>{u[p]=s.properties[p]}),{...s,properties:u}});this.features=i,this.fetchSuccessful=!0}else this.fetchSuccessful=!1;U("hideLoading",{})}).catch(r=>{console.error("Error:",r),this.fetchSuccessful=!1})}}),lt([[Qt,"#attributeTable"]]),document.getElementById("layerSelect").addEventListener("change",function(){F.store("attributeTable").updateTableForLayer(this.value)}),document.addEventListener("geonodeCustomLayerFilterUpdated",function(e){console.debug('Custom event "geonodeCustomLayerFilterClosed" caught.'),F.store("attributeTable").filterString=F.store("geonodeCustomLayerFilter").allFormValues["daard-database"],F.store("attributeTable").updateTableForLayer("Daard Database")})};export{er as initialize};
//# sourceMappingURL=attributeTable-9e7c0650.js.map
